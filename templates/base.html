{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{% block title %}FoodieNet{% endblock %}</title>
  <link href="{% static 'css/output.css' %}" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen font-sans">

  <!-- Header -->
  <header class="relative bg-cover bg-center h-[320px] flex flex-col justify-between text-white" 
          style="background-image: url('{% static 'images/header-bg.jpg' %}');">
    <div class="absolute inset-0 bg-black/50"></div>

    <!-- Navbar -->
    <div class="relative z-10 w-11/12 max-w-7xl mx-auto flex justify-between items-center py-4">
      <!-- Logo + Nav -->
      <div class="flex items-center gap-6">
        <a href="{% url 'lista_recetas' %}" class="text-3xl font-extrabold tracking-wide hover:text-orange-400 transition">
          FoodieNet
        </a>
        <nav class="hidden md:flex gap-6">
          <a href="{% url 'lista_recetas' %}" class="hover:text-orange-400 transition">Inicio</a>
          {% if user.is_authenticated %}
            <a href="{% url 'feed_amigos' %}" class="hover:text-orange-400 transition">Feed Amigos</a>
            <a href="{% url 'crear_receta' %}" class="hover:text-orange-400 transition">Nueva Receta</a>
            <a href="{% url 'listar_planes_diarios' %}" class="hover:text-orange-400 transition">Plan Diario</a>
          {% endif %}
        </nav>
      </div>

      <!-- Search + Perfil -->
      <div class="flex items-center gap-4">
        <!-- Search -->
        <form method="get" action="{% url 'users:buscar_usuarios_y_recetas' %}" class="flex">
          <input type="text" name="query" placeholder="Buscar..."
                 value="{{ request.GET.query|default:'' }}"
                 class="px-3 py-2 rounded-l-md border border-gray-300 focus:ring-2 focus:ring-orange-400 focus:outline-none text-gray-800">
          <button type="submit" 
                  class="bg-orange-500 hover:bg-orange-600 px-4 py-2 rounded-r-md text-white font-semibold transition">
            Buscar
          </button>
        </form>

        {% if user.is_authenticated %}
          <!-- Dropdown Perfil -->
          <div class="relative group">
            <button class="flex items-center gap-2 focus:outline-none">
              <img src="{{ user.perfil.get_foto_url }}" alt="Foto perfil {{ user.username }}" class="w-9 h-9 rounded-full object-cover border-2 border-white shadow">
              <span class="hidden sm:inline">{{ user.username }}</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
              </svg>
            </button>
            <!-- Dropdown Menu -->
            <div class="absolute right-0 mt-2 w-48 bg-white text-gray-800 rounded-lg shadow-lg hidden group-hover:block">
              <a href="{% url 'users:perfil' %}" class="block px-4 py-2 hover:bg-gray-100">Ir a mi perfil</a>
              <form method="post" action="{% url 'authentication:logout' %}">
                {% csrf_token %}
                <button type="submit" class="w-full text-left px-4 py-2 hover:bg-gray-100">Cerrar sesión</button>
              </form>
            </div>
          </div>
        {% else %}
          <a href="{% url 'authentication:login' %}" 
             class="px-4 py-2 rounded-lg border border-white hover:bg-white hover:text-orange-600 transition">Iniciar sesión</a>
          <a href="{% url 'authentication:register' %}" 
             class="px-4 py-2 rounded-lg bg-orange-500 hover:bg-orange-600 font-semibold transition">Registrarse</a>
        {% endif %}
      </div>
    </div>

    <!-- Tagline -->
    <div class="relative z-10 text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold drop-shadow-lg">Comparte y descubre recetas increíbles</h1>
      <p class="mt-3 text-lg drop-shadow">Únete a la comunidad de FoodieNet y lleva tu pasión por la cocina al siguiente nivel.</p>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-grow w-11/12 max-w-5xl mx-auto mt-8 bg-white shadow-md rounded-xl p-6">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="bg-gray-900 text-gray-400 text-center py-6 mt-8">
    © {% now "Y" %} <span class="text-white font-semibold">FoodieNet</span>. Todos los derechos reservados.
  </footer>

</body>
</html>
