<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Recetas recomendadas</title>
</head>
<body>
    <h1>Recetas recomendadas</h1>

        {% if recetas_recomendadas %}
        <ul>
            {% for receta in recetas_recomendadas %}
                <li style="margin-bottom: 24px;">
                    <a href="{% url 'detalle_receta' receta.id %}">
                        <h2>{{ receta.titulo }}</h2>
                    </a>

                    {% if receta.imagen %}
                        <img src="{{ receta.imagen.url }}" alt="Imagen de {{ receta.titulo }}" width="200">
                    {% endif %}

                    <p><strong>Tiempo de preparaci√≥n:</strong> {{ receta.tiempo_preparacion }} minutos</p>
                    <p><strong>Dificultad:</strong> {{ receta.dificultad }}</p>
                    <p><strong>Etiquetas:</strong> {{ receta.tags.all|join:", " }}</p>

                    {% if user.is_authenticated %}
                        <form method="post" action="{% url 'toggle_like' receta.pk %}" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" style="background:none; border:none; cursor:pointer; font-size:1.2em;">
                                {% if receta.id in likes_usuario %}
                                    ‚ù§Ô∏è
                                {% else %}
                                    ü§ç
                                {% endif %}
                                {{ receta.likes.count }}
                            </button>
                        </form>

                        <form method="post" action="{% url 'toggle_favorito' receta.pk %}" style="display:inline; margin-left:10px;">
                            {% csrf_token %}
                            <button type="submit" style="background:none; border:none; cursor:pointer; font-size:1.2em;">
                                {% if receta.id in favoritos_usuario %}
                                    ‚òÖ
                                {% else %}
                                    ‚òÜ
                                {% endif %}
                                {{ receta.favorito_set.count }}
                            </button>
                        </form>
                    {% else %}
                        <p>
                            <a href="{% url 'authentication:login' %}?next={% url 'recomendaciones' receta_base.id %}">
                                Inicia sesi√≥n
                            </a> para dar like o favorito.
                        </p>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No se encontraron recetas recomendadas.</p>
    {% endif %}


    <a href="{% url 'lista_recetas' %}">Volver al inicio</a>
</body>
</html>
