{% extends "base.html" %}

{% block content %}

{% if recomendaciones %}
<section class="my-10">
  <div class="bg-white border border-indigo-100 shadow-lg rounded-2xl p-6">
    <h2 class="text-2xl font-bold text-indigo-700 flex items-center gap-2 mb-6">
      üéØ Recomendaciones para ti
    </h2><div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
     {% for receta in recomendaciones %}
  <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition overflow-hidden min-h-[350px]">
    {% if receta.imagen %}
      <img 
        src="{{ receta.imagen.url }}" 
        alt="{{ receta.titulo }}"
        class="w-full h-56 object-cover"
      >
    {% else %}
      <div class="w-full h-56 flex items-center justify-center bg-gray-200 text-gray-500 text-4xl">
        üì∑
      </div>
    {% endif %}
    <div class="p-4">
      <h3 class="text-lg font-semibold text-gray-800 mb-1">
        <a href="{% url 'detalle_receta' receta.pk %}" class="hover:text-indigo-600 transition">
          {{ receta.titulo }}
        </a>
      </h3>
      <p class="text-sm text-gray-500 mb-2">
        {% if tipo_recomendacion == "likes" %}
          Basado en tus √∫ltimos likes
        {% else %}
          Recetas populares para ti
        {% endif %}
      </p>
      <p class="text-gray-600 text-sm">{{ receta.descripcion|truncatewords:20 }}</p>
    </div>
  </div>
{% endfor %}

    </div>
  </div>
</section>
{% endif %}


<div class="container mx-auto px-4 my-10">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-800">üç¥ Lista de Recetas</h1>
    {% if user.is_authenticated %}
      <a href="{% url 'crear_receta' %}" 
         class="bg-indigo-600 text-white px-4 py-2 rounded-lg shadow hover:bg-indigo-700 transition">
        ‚ûï Crear nueva receta
      </a>
    {% endif %}
  </div>

  {% if page_obj %}
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    {% for receta in page_obj %}
    <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition overflow-hidden">
      {% if receta.imagen %}
      <img 
        src="{{ receta.imagen.url }}" 
        alt="{{ receta.titulo }}"
        class="w-full h-56 object-cover"
      >
      {% endif %}
      <div class="p-5">
        <h3 class="text-xl font-semibold text-gray-800 flex items-center gap-2 mb-3">
          <a href="{% url 'detalle_receta' receta.pk %}" class="hover:text-indigo-600 transition">
            {{ receta.titulo }}
          </a>
          {% if receta.es_publica %}
            <span class="inline-block bg-green-500 text-white text-sm px-3 py-1 rounded-full font-semibold shadow-lg">
  P√∫blica
</span>





          {% else %}
            <span class="inline-block bg-red-500 text-white rounded-full" style="font-size:0.625rem; padding:0.15rem 0.3rem;">
  Privada
</span>
          {% endif %}
        </h3>
        <div class="flex items-center gap-3 mb-3">
          <img src="{{ receta.autor.perfil.get_foto_url }}" 
               alt="Foto de {{ receta.autor.username }}"
               class="w-10 h-10 rounded-full object-cover border border-gray-200">
          <small class="text-gray-500">Por: {{ receta.autor.username }}</small>
        </div>
        <p class="text-gray-600 leading-relaxed">{{ receta.descripcion|truncatewords:25 }}</p>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Paginaci√≥n -->
  <div class="flex justify-center items-center gap-2 mt-10 text-gray-600">
    {% if page_obj.has_previous %}
      <a href="?page=1" class="px-3 py-1 rounded-lg bg-gray-100 hover:bg-indigo-100">&laquo;&laquo;</a>
      <a href="?page={{ page_obj.previous_page_number }}" class="px-3 py-1 rounded-lg bg-gray-100 hover:bg-indigo-100">&laquo;</a>
    {% else %}
      <span class="px-3 py-1 text-gray-400">&laquo;&laquo;</span>
      <span class="px-3 py-1 text-gray-400">&laquo;</span>
    {% endif %}

    <span class="px-4 py-1 rounded-lg bg-indigo-600 text-white">
      P√°gina {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
    </span>

    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}" class="px-3 py-1 rounded-lg bg-gray-100 hover:bg-indigo-100">&raquo;</a>
      <a href="?page={{ page_obj.paginator.num_pages }}" class="px-3 py-1 rounded-lg bg-gray-100 hover:bg-indigo-100">&raquo;&raquo;</a>
    {% else %}
      <span class="px-3 py-1 text-gray-400">&raquo;</span>
      <span class="px-3 py-1 text-gray-400">&raquo;&raquo;</span>
    {% endif %}
  </div>
  {% else %}
    <p class="text-gray-500 mt-8 text-center">No hay recetas disponibles.</p>
  {% endif %}
</div>
{% endblock %}


<script>
  const myCarousel = document.querySelector('#carouselRecomendaciones');
  const carousel = new bootstrap.Carousel(myCarousel, {
    interval: 6000,  // cambia cada 6 segundos
    ride: 'carousel',
    pause: false,
    wrap: true
  });
</script>
